Submission: Dino Fun World Assignment
Assignment Description
You, in your role as a data explorer and visualizer, have been asked by the administrators of a small amusement park in your hometown to answer a few questions about their park operations. The dataset that they provided for you to perform the requested analysis includes the movement and communication data captured from the park attendees' apps during one weekend (Friday, Saturday, and Sunday).

The administrators would like you to answer three relatively simple questions about the park activities on the day in question. These questions all deal with park operations and can be answered using the data provided.

Question 1: What is the most popular attraction to visit in the park?
Question 2: What ride (note that not all attractions are rides) has the second longest average visit time?
Question 3: Which Fast Food offering has the fewest visitors?

Directions
The database provided by the park administration is formatted to be readable by any SQL database library. The course staff recommends the sqlite3 library. The database contains three tables, named checkin, attractions, and sequences. The database file is named 'dinofunworld.db' and is available in the '/course/data/CSE-578/dinofunworld.db' path.

Note: Please note that the database file is accessible through the learner submission workspace, which requires establishing a connection with the database. For downloading the dataset and potentially working locally, refer to the overview document page.

The information contained in each of these tables is listed below:

checkin: - The check-in data for all visitors for the day in the park. The data includes two types of check-ins: inferred and actual checkins. 

         - Fields: visitorID, timestamp, attraction, duration, type 

attraction: - The attractions in the park by their corresponding AttractionID, Name, Region, Category, and type. Regions are from the VAST Challenge map such as Coaster Alley, Tundra Land, etc. Categories include Thrill rides, Kiddie Rides, etc. Type is broken into Outdoor Coaster, Other Ride, Carousel, etc. 

         - Fields: AttractionID, Name, Region, Category, type

 sequences: - The check-in sequences of visitors. These sequences list the position of each visitor to the park every five minutes. If the visitor has not entered the part yet, the sequence has a value of 0 for that time interval. If the visitor is in the park, the sequence lists the attraction they have most recently checked in to until they check in to a new one or leave the park. 

           - Fields: visitorID, sequence

Using the provided data, answer the three questions that the administrators have asked.

Submission Directions for Assignment Deliverables
This assignment will be auto-graded. You must complete and submit your work through Ed Lesson’s code challenge to receive credit for the course:

1. In order for your answers to be correctly registered in the system, you must place the code for your answers in the cell indicated for each question. 

You should submit the assignment with the output of the code in the cell's display area. The display area should contain only your answer to the question with no extraneous information, or else the answer may not be picked up correctly. 

Each cell that is going to be graded has a set of comment lines (ex: ### TEST FUNCTION: test_question1) at the beginning of the cell. This line is extremely important and must not be modified or removed.

2. After completing the notebook, run each code cell individually or click “Run All” at the top to print the outputs.
3. When you are ready to submit your completed work, click on “Mark” at the bottom right of the screen. 
4. You will know you have successfully completed the assignment when feedback appears for each test case with a score.
5. If needed: to resubmit the assignment in Ed Lesson 

Edit your work in the notebook
Run the code cells again
Click “Mark” at the bottom of the screen 

Your submission will be reviewed by the course team and then, after the due date has passed, your score will be populated from Ed Lesson into your Canvas grade.

Evaluation
There are three parts in the grading, and each part has one test case where the total number of points for all parts is 50. If the submission fails, we will return the corresponding error messages. If the submission is correct, you will see "Correct" with scores for each part.

Please execute each cell in the Notebook before submitting.


Add your import statements and the database connection statements in the below code block
Database file path = '/course/data/CSE-578/dinofunworld.db'
[1]
#your code here
import sqlite3
connection = sqlite3.connect('/course/data/CSE-578/dinofunworld.db')
cursor = connection.cursor()

Question 1:
What is the most popular attraction to visit in the park?
Note: Your output should be the name of the attraction. Please print your output in the cell below.
[2]
### TEST FUNCTION: test_question1
# DO NOT REMOVE THE LINE ABOVE
# your code here
cursor.execute('''
    SELECT Name 
    FROM attraction
    JOIN (
        SELECT attraction, COUNT(*) as visit_count 
        FROM checkin 
        GROUP BY attraction
        ORDER BY visit_count DESC
        LIMIT 1
    ) AS most_popular
    ON attraction.AttractionID = most_popular.attraction
''')
question1_result = cursor.fetchone()[0]
print(question1_result)

Question 2:
What ride (note that not all attractions are rides) has the second longest average visit time?
Note: Your output should be the name of the ride. Please print your output in the cell below.
[3]
### TEST FUNCTION: test_question2
# DO NOT REMOVE THE LINE ABOVE
# your code here
cursor.execute('''
    SELECT Name 
    FROM attraction
    JOIN (
        SELECT attraction, AVG(duration) as avg_duration
        FROM checkin
        WHERE type = "actual"
        GROUP BY attraction
        ORDER BY avg_duration DESC
        LIMIT 1 OFFSET 1
    ) AS second_longest
    ON attraction.AttractionID = second_longest.attraction
''')
question2_result = cursor.fetchone()[0]
print(question2_result)


Question 3:
Which Fast Food offering in the park has the fewest visitors?
Note: Your output should be the name of the fast food offering. Please print your output in the cell below.
[4]
### TEST FUNCTION: test_question3
# DO NOT REMOVE THE LINE ABOVE
# your code here
cursor.execute('''
    SELECT Name
    FROM attraction
    JOIN (
        SELECT attraction, COUNT(DISTINCT visitorID) as visitor_count
        FROM checkin
        GROUP BY attraction
        ORDER BY visitor_count ASC
    ) AS fewest_visitors
    ON attraction.AttractionID = fewest_visitors.attraction
    WHERE type = 'Fast Food'
    LIMIT 1
''')
question3_result = cursor.fetchone()[0]
print(question3_result)
















